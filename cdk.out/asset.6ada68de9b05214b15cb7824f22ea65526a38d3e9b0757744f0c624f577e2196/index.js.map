{
  "version": 3,
  "sources": ["../asset-input/src/functions/auth/define-auth-challenge/index.ts"],
  "sourcesContent": ["interface ChallengeSession {\n    challengeName: string;\n    challengeResult: boolean;\n}\n\ninterface AuthEvent {\n    request: {\n        userNotFound?: boolean;\n        session: ChallengeSession[];\n    };\n    response: AuthResponse;\n}\n\ninterface AuthResponse {\n    isValid?: boolean;\n    challengeName?: string;\n    issueTokens: boolean;\n    failAuthentication: boolean;\n}\n\nexport const handler = async (event: AuthEvent): Promise<AuthEvent> => {\n    const { request } = event;\n    \n    // If user is not found, fail\n    if (request.userNotFound) {\n        event.response = {\n            isValid: false,\n            failAuthentication: true,\n            issueTokens: false\n        };\n        return event;\n    }\n\n    // Initialize session if undefined\n    if (!request.session) {\n        request.session = [];\n    }\n\n    if (request.session.length === 0) {\n        // First challenge - send OTP\n        event.response = {\n            challengeName: 'CUSTOM_CHALLENGE',\n            issueTokens: false,\n            failAuthentication: false\n        };\n    } else if (request.session.length === 1 && request.session[0].challengeName === 'CUSTOM_CHALLENGE') {\n        // Verify the OTP\n        if (request.session[0].challengeResult === true) {\n            event.response = {\n                issueTokens: true,\n                failAuthentication: false\n            };\n        } else {\n            event.response = {\n                issueTokens: false,\n                failAuthentication: true\n            };\n        }\n    } else {\n        event.response = {\n            issueTokens: false,\n            failAuthentication: true\n        };\n    }\n\n    return event;\n};"],
  "mappings": "yaAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,aAAAE,IAAA,eAAAC,EAAAH,GAoBO,IAAME,EAAU,MAAOE,GAAyC,CACnE,GAAM,CAAE,QAAAC,CAAQ,EAAID,EAGpB,OAAIC,EAAQ,cACRD,EAAM,SAAW,CACb,QAAS,GACT,mBAAoB,GACpB,YAAa,EACjB,EACOA,IAINC,EAAQ,UACTA,EAAQ,QAAU,CAAC,GAGnBA,EAAQ,QAAQ,SAAW,EAE3BD,EAAM,SAAW,CACb,cAAe,mBACf,YAAa,GACb,mBAAoB,EACxB,EACOC,EAAQ,QAAQ,SAAW,GAAKA,EAAQ,QAAQ,CAAC,EAAE,gBAAkB,mBAExEA,EAAQ,QAAQ,CAAC,EAAE,kBAAoB,GACvCD,EAAM,SAAW,CACb,YAAa,GACb,mBAAoB,EACxB,EAEAA,EAAM,SAAW,CACb,YAAa,GACb,mBAAoB,EACxB,EAGJA,EAAM,SAAW,CACb,YAAa,GACb,mBAAoB,EACxB,EAGGA,EACX",
  "names": ["define_auth_challenge_exports", "__export", "handler", "__toCommonJS", "event", "request"]
}
